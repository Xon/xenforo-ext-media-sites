<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="public" template="PAGE_CONTAINER" modification_key="s9e_MediaSites_Footer" description="Adds a link to this add-on to the page footer" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[((\s*)(\{\{ phrase\('extra_copyright'\) \}\}))]]></find>
    <replace><![CDATA[$1$2$1| <a class="u-concealed" dir="ltr" target="_blank" href="https://xenforo.com/community/resources/s9e-media-sites.5973/">Media embeds via s9e/MediaSites</a>]]></replace>
  </modification>
  <modification type="public" template="_media_site_embed_facebook" modification_key="s9e_MediaSites_Facebook_Background" description="Force Facebook's embeds to have a white background" execution_order="10" enabled="0" action="str_replace">
    <find><![CDATA[style="]]></find>
    <replace><![CDATA[style="background:#fff;]]></replace>
  </modification>
  <modification type="public" template="_media_site_embed_instagram" modification_key="s9e_MediaSites_Instagram_v2" description="Enables the experimental Instagram iframe resizing" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[(onload="[^"]*"(.*?)src="[^"]*")]]></find>
    <replace><![CDATA[data-s9e-mediaembed-api="2" onload="var c=new MessageChannel;c.port1.onmessage=function(e){style.height=e.data+'px'};contentWindow.postMessage('s9e:init','https://s9e.github.io',[c.port2])"$1src="https://s9e.github.io/iframe/2/instagram.min.html#{$id}"]]></replace>
  </modification>
  <modification type="public" template="_media_site_embed_twitter" modification_key="s9e_MediaSites_Twitter_v2" description="Enables the experimental Twitter iframe resizing" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[(onload="[^"]*"(.*?)src="[^"]*")]]></find>
    <replace><![CDATA[data-s9e-mediaembed-api="2" onload="var c=new MessageChannel;c.port1.onmessage=function(e){style.height=e.data+'px'};contentWindow.postMessage('s9e:init','https://s9e.github.io',[c.port2])"$1src="https://s9e.github.io/iframe/2/twitter.min.html#{$id}"]]></replace>
  </modification>
  <modification type="public" template="_media_site_embed_youtube" modification_key="s9e_MediaSites_YouTube_Privacy" description="Enables YouTube's privacy-enhanced mode." execution_order="10" enabled="0" action="str_replace">
    <find><![CDATA[src="https://www.youtube.com/embed/]]></find>
    <replace><![CDATA[src="https://www.youtube-nocookie.com/embed/]]></replace>
  </modification>
  <modification type="public" template="bb_code.less" modification_key="s9e_MediaSites_EmbedsInQuotes" description="Limits the size of embeds within expandable quotes" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[(^)]]></find>
    <replace><![CDATA[.is-expandable:not(.is-expanded) [data-s9e-mediaembed]
{
	max-width: 250px !important;
}
.is-expandable:not(.is-expanded) [data-s9e-mediaembed] iframe
{
	position: unset !important;
}
$0]]></replace>
  </modification>
  <modification type="public" template="core.less" modification_key="s9e_MediaSites_SmoothIframes" description="Adds a short CSS transition for dynamically-sized iframes" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[(^)]]></find>
    <replace><![CDATA[iframe[data-s9e-mediaembed] { transition: all .2s }

$0]]></replace>
  </modification>
  <modification type="public" template="editor.less" modification_key="s9e_MediaSites_InsertMediaScroller" description="Adds a scrollbar to the list of media sites in the Insert Media dialog" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[(^)]]></find>
    <replace><![CDATA[#editor_media_form ul
{
	max-height: 33vh;
	overflow-y: scroll;
}
$0]]></replace>
  </modification>
  <modification type="public" template="xfmg_media_list.less" modification_key="s9e_MediaSites_XFMG" description="Removes the size limits of embedded media in XFMG" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[(^)]]></find>
    <replace><![CDATA[.media-container>.bbWrapper>[data-s9e-mediaembed]
{
	max-width: 100% !important;
}
$0]]></replace>
  </modification>
</template_modifications>
